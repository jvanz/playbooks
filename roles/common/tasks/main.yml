- debug:
    msg: "Target distribution: {{ ansible_distribution }}"

- debug:
    msg: "Target distribution: {{ ansible_facts['distribution_major_version'] }}"

- name: install the python-xml lib needed to ansible works
  command: zypper install -y python-xml
  become: yes
  when: ansible_distribution == "openSUSE Leap" or ansible_distribution == "openSUSE Tumbleweed" or ansible_distribution == "SLES"

- name: update all package
  when: ansible_distribution == "openSUSE Leap" or ansible_distribution == "openSUSE Tumbleweed" or ansible_distribution == "SLES"
  become: yes
  zypper:
    name: '*'
    state: latest

- name: apply all patches
  when: ansible_distribution == "openSUSE Leap" or ansible_distribution == "openSUSE Tumbleweed" or ansible_distribution == "SLES"
  become: yes
  zypper:
    name: '*'
    state: latest
    type: patch
