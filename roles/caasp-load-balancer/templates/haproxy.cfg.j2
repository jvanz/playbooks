global
  log /dev/log local0 info 


  chroot /var/lib/haproxy 


  user haproxy
  group haproxy
  daemon

defaults
  mode       tcp
  log        global
  option     tcplog
  option     redispatch
  option     tcpka
  retries    2
  http-check     expect status 200 


  default-server check check-ssl verify none
  timeout connect 5s
  timeout client 5s
  timeout server 5s
  timeout tunnel 86400s 



listen stats 


  bind    *:9000
  mode    http
  stats   hide-version
  stats   uri       /stats

listen apiserver 


  bind   *:6443
  option httpchk GET /healthz
  {% for master in masters %}
  server master{{loop.index0}} {{master}}:6443
  {% endfor %}

listen dex 


  bind   *:32000
  option httpchk GET /healthz
  {% for master in masters %}
  server master{{loop.index0}} {{master}}:32000
  {% endfor %}

listen gangway 


  bind   *:32001
  option httpchk GET /
  {% for master in masters %}
  server master{{loop.index0}} {{master}}:32001
  {% endfor %}
